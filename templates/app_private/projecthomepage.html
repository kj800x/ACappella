{% extends 'app_private.html' %}

{% block SpareJavascript %}

<script type="text/javascript">

function edithithelper(id){
	newseconds = prompt("What is the location of the hitmark (in seconds from the beginning of the song)", $("#hit_"+id+"_seconds").text());
	newlabel = prompt("What is the label for the hitmark", $("#hit_"+id+"_label").text());
	edithit(id, newlabel, newseconds);
}

	$(function() {
			$( "#accordion" ).accordion({collapsible: true, heightStyle: "content", active: false });
	});
</script>

{% endblock SpareJavascript %}

{% block content %}

	<h3> <a href="../..">GO BACK TO COLLECTION</a> </h3>
	
	<h1> {{project.title}} </h1>
	<p> {{project.preformance_Notes|linebreaksbr}} </p>
	
	<h3> <a href="/app/public/collection/{{collection.id}}/project/{{project.id}}/">This Project's Public Page</a> </h3>

	<div id="accordion">
		<h3> CHANNELS </h3>
		<div>
			{% if Channels %}
				<h3> Channels in {{project.title}} </h3>
				<table>
				{% for a in Channels %}
					<tr id="chan_{{a.id}}">
						<td><span id="chan_{{a.id}}_title">{{a.title}}</span></td>
						<td>(<a href="#" onclick="channeldelete({{a.id}})">DELETE</a>)</td>
						<td>(<a href="#" onclick="channelmove({{a.id}}, 'up')">UP</a>)</td>
						<td>(<a href="#" onclick="channelmove({{a.id}}, 'down')">DOWN</a>)</td>
						<td>(<a href="#" onclick="channelrename({{a.id}}, prompt('What is the new name?'))">RENAME</a>)</td>
					</tr>
				{% endfor %}
				</table>
			{% else %}
				<h3> There are no channels in this project. </h3>
			{% endif %}
			<h3><a href="./upload/"> Upload a channel </a></h3>
		</div>
		<h3> HIT POINTS </h3>
		<div>
			{% if Hits %}
				<h3> Hit Points in {{project.title}} </h3>
				{% for a in Hits %}
					<span id="hit_{{a.id}}"><span id="hit_{{a.id}}_label">{{a.label}}</span> (<span id="hit_{{a.id}}_seconds">{{a.seconds_Mark}}</span>)
					(<a href="#" onclick="deletehit({{a.id}})">DELETE</a>)
					(<a href="#" onclick="edithithelper({{a.id}})">EDIT</a>)<br /></span>
				{% endfor %}
			{% else %}
				<h3> There are no hit points in this project. </h3>
			{% endif %}
			<h3><a href="./makehit/"> SET A HIT POINT </a></h3>
		</div>
		<h3> PDF </h3>
		<div>	
			{% if project.pdf %}
			<h3><a href="#" id="pdfblock" onclick="deletepdf({{project.id}})"> REMOVE PDF </a></h3>
			{% else %}
			<h3><a href="./pdf/"> UPLOAD PDF </a></h3>
			{% endif %}
		</div>
		<h3> EDIT PROJECT DETAILS: {{project.title}} </h3>
		<div>
			<form action="" method="POST">{% csrf_token %}
			<input type="hidden" name="__KEVIN_WHICH" value="E" />
				{% include 'formsnippet.html' with form=EditProjectForm title="Edit this project" panel=3 %}
			</form>
		</div>
		<h3>DELETE PROJECT</h3>
		<div>
			<form action="" method="POST">{% csrf_token %}
			<input type="hidden" name="__KEVIN_WHICH" value="D" />
			<input type="submit" style="border:4px solid red; background-color:pink;margin:30px" value="Delete this project" />
			</form>
		</div>
	</div>
	<div id="errorbox" style="display:none"></div>
	<script type="text/javascript">
	$( "#accordion" ).on( "accordioncreate", function( event, ui ) {
	
			$( "#accordion" ).accordion( "option", "active", window.errorpanel );
	
	} );
	</script>
{% endblock content %}

{% block title %}{{project.title}}{% endblock title %}